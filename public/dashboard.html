<!DOCTYPE html>
<html>
<head>
  <title>PlacementPro Dashboard</title>
  <link rel="stylesheet" href="assets/style.css">
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>

<div class="layout">

  <!-- Sidebar -->
  <div class="sidebar">
    <h2>PlacementPro</h2>
    <div class="menu" id="menu"></div>
  </div>

  <!-- Main Content -->
  <div class="main">

    <!-- Top Navigation Bar -->
    <div class="topbar">
      <div id="userInfo" class="user-info"></div>
      <button onclick="logout()" class="logout">Logout</button>
    </div>

    <!-- Dynamic Page Content -->
    <div id="content"></div>

  </div>

</div>
<!-- ============================= -->
<!-- STUDENT FAQ CHATBOT -->
<!-- ============================= -->

<style>
:root {
  --primary-gradient: linear-gradient(135deg, #4e73df, #6f42c1);
  --primary-color: #4e73df;
  --bg-dark: #1f2430;
  --card-dark: #2a3042;
  --text-light: #f1f3f8;
  --text-muted: #c5c9d6;
}

/* Chat Icon */
#pp-chatbot-icon {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 58px;
  height: 58px;
  background: var(--primary-gradient);
  color: white;
  border-radius: 50%;
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  cursor: pointer;
  box-shadow: 0 10px 25px rgba(78,115,223,0.4);
  z-index: 9999;
  transition: 0.3s ease;
}

#pp-chatbot-icon:hover {
  transform: translateY(-4px) scale(1.05);
  box-shadow: 0 15px 35px rgba(78,115,223,0.6);
}

/* Chat Window */
#pp-chatbot-window {
  position: fixed;
  bottom: 95px;
  right: 25px;
  width: 340px;
  background: var(--card-dark);
  border-radius: 14px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.5);
  display: none;
  flex-direction: column;
  overflow: hidden;
  font-family: 'Segoe UI', sans-serif;
  z-index: 9999;
  border: 1px solid rgba(255,255,255,0.08);
}

/* Header */
#pp-chatbot-header {
  background: var(--primary-gradient);
  color: white;
  padding: 14px;
  font-weight: 600;
  letter-spacing: 0.5px;
  font-size: 15px;
}

/* Body */
#pp-chatbot-body {
  padding: 12px;
  max-height: 380px;
  overflow-y: auto;
  background: transparent;
}

/* Scrollbar */
#pp-chatbot-body::-webkit-scrollbar {
  width: 6px;
}
#pp-chatbot-body::-webkit-scrollbar-thumb {
  background: #4e73df;
  border-radius: 10px;
}

/* Bot Message */
.pp-bot-msg {
  background: rgba(255,255,255,0.06);
  color: var(--text-light);
  padding: 10px 12px;
  margin: 8px 0;
  border-radius: 10px;
  font-size: 13px;
  line-height: 1.5;
  border: 1px solid rgba(255,255,255,0.05);
  animation: fadeIn 0.3s ease;
}

/* Option Buttons */
.pp-option-btn {
  width: 100%;
  padding: 8px;
  margin: 6px 0;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 8px;
  cursor: pointer;
  font-size: 13px;
  color: var(--text-light);
  transition: 0.25s ease;
}

.pp-option-btn:hover {
  background: var(--primary-color);
  border-color: var(--primary-color);
  transform: translateX(3px);
}

/* Smooth animation */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(5px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
<div id="pp-chatbot-icon">Chat</div>

<div id="pp-chatbot-window">
  <div id="pp-chatbot-header">Placement FAQ Bot</div>
  <div id="pp-chatbot-body">

    <div class="pp-bot-msg">How can I help you?</div>

    <button class="pp-option-btn" onclick="ppAskBot('interview_date')">Interview Date</button>
    <button class="pp-option-btn" onclick="ppAskBot('applied_jobs')">Applied Jobs</button>
    <button class="pp-option-btn" onclick="ppAskBot('application_status')">Application Status</button>
    <button class="pp-option-btn" onclick="ppAskBot('placement_status')">Placement Status</button>
    <button class="pp-option-btn" onclick="ppAskBot('active_drives')">Active Drives</button>
    <button class="pp-option-btn" onclick="ppAskBot('placement_stats')">Placement Statistics</button>

    <div id="pp-bot-response"></div>

  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

  const role = localStorage.getItem("role");
  const icon = document.getElementById("pp-chatbot-icon");
  const windowBox = document.getElementById("pp-chatbot-window");

  if (role === "STUDENT") {
    icon.style.display = "flex";
  }

  icon.onclick = function () {
    windowBox.style.display =
      windowBox.style.display === "flex" ? "none" : "flex";
  };
});

async function ppAskBot(action) {

  const studentId = localStorage.getItem("userId");

  if (!studentId) {
    alert("Student ID not found.");
    return;
  }

  try {
    const response = await fetch(
      "../api/chatbot_api.php?action=" + action + "&studentId=" + studentId
    );

    const data = await response.json();

    document.getElementById("pp-bot-response").innerHTML +=
      '<div class="pp-bot-msg">' + data.reply + '</div>';

  } catch (error) {
    document.getElementById("pp-bot-response").innerHTML +=
      '<div class="pp-bot-msg">Unable to connect to server.</div>';
  }
}
</script>
<script src="assets/app.js"></script>
<script>
  initDashboard();
</script>

</body>
</html>